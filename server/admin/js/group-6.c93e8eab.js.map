{"version":3,"sources":["webpack:///./src/views/power/PowerList.vue?ebc9","webpack:///./src/views/power/PowerEdit.vue?4d42","webpack:///src/views/power/PowerEdit.vue","webpack:///./src/views/power/PowerEdit.vue?5e57","webpack:///./src/views/power/PowerEdit.vue","webpack:///./node_modules/core-js/modules/es.array.some.js","webpack:///./src/views/power/PowerEdit.vue?822f","webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./src/views/power/PowerList.vue?8bfe","webpack:///src/views/power/PowerList.vue","webpack:///./src/views/power/PowerList.vue?41c5","webpack:///./src/views/power/PowerList.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","path","_v","_s","id","nativeOn","$event","preventDefault","save","on","getPower","isShow","saveMenu","ref","menus","nodes","click","scopedSlots","_u","key","fn","node","data","name","level","handleRead","model","value","callback","$$v","$set","expression","handleWrite","_e","slot","staticRenderFns","props","methods","merge","a","write","b","read","children","length","i","clearLastChild","arr","collect","ch","field","pre","some","flag","filter","menu","$refs","tree","getCheckedKeys","s","c","forEach","undefined","syncNode","$message","warning","arrget","setChecked","setCheckedKeys","created","fetch","fetchGetMenus","component","$","$some","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","target","proto","forced","callbackfn","arguments","$filter","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","items","scope","getStyle","row","$router","push","remove","tagType"],"mappings":"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","file":"js/group-6.c93e8eab.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerList.vue?vue&type=style&index=0&id=086aa685&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerList.vue?vue&type=style&index=0&id=086aa685&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"about\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"系统管理\")]),_c('el-breadcrumb-item',[_vm._v(_vm._s(_vm.id ? '编辑' : '新建')+\"权限\")])],1),_c('el-form',{attrs:{\"label-width\":\"120px\"},nativeOn:{\"submit\":function($event){$event.preventDefault();return _vm.save($event)}}},[_c('el-form-item',{attrs:{\"label\":\"关联菜单\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.getPower}},[_vm._v(\"分配权限\")]),_c('el-dialog',{attrs:{\"title\":\"【写权限在读权限开启后有效,非操作菜单没有写权限】\",\"visible\":_vm.isShow,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.isShow=$event},\"close\":_vm.saveMenu}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.menus,\"default-checked-keys\":_vm.nodes,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"node-key\":\"name\",\"highlight-current\":\"\"},on:{\"check-change\":_vm.click},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"custom-tree-node\"},[_c('span',[_vm._v(_vm._s(data.name))]),(node.level==3)?_c('span',[_vm._v(\" 读权限 \"),_c('el-switch',{attrs:{\"active-color\":\"#0af\",\"inactive-color\":\"#bbb\"},on:{\"change\":function($event){return _vm.handleRead(data,node)}},model:{value:(data.read),callback:function ($$v) {_vm.$set(data, \"read\", $$v)},expression:\"data.read\"}}),_vm._v(\" 写权限 \"),_c('el-switch',{attrs:{\"active-color\":\"#0af\",\"inactive-color\":\"#bbb\"},on:{\"change\":function($event){return _vm.handleWrite(data,node)}},model:{value:(data.write),callback:function ($$v) {_vm.$set(data, \"write\", $$v)},expression:\"data.write\"}})],1):_vm._e()])}}])}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.isShow = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.isShow = false}}},[_vm._v(\"确 定\")])],1)],1)],1),_c('el-form-item',{attrs:{\"label\":\"权限名\"}},[_c('el-input',{model:{value:(_vm.model.name),callback:function ($$v) {_vm.$set(_vm.model, \"name\", $$v)},expression:\"model.name\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"native-type\":\"submit\"}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"about\">\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>系统管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>{{ id ? '编辑' : '新建' }}权限</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n\r\n    <el-form label-width=\"120px\" @submit.native.prevent=\"save\">\r\n      <!-- 权限分配 -->\r\n      <el-form-item label=\"关联菜单\">\r\n        <el-button type=\"primary\" @click=\"getPower\">分配权限</el-button>\r\n        <!-- 弹窗 -->\r\n        <el-dialog title=\"【写权限在读权限开启后有效,非操作菜单没有写权限】\" :visible.sync=\"isShow\" width=\"50%\" @close=\"saveMenu\">\r\n          <!-- 菜单权限树 -->\r\n          <el-tree :data=\"menus\" :default-checked-keys=\"nodes\" show-checkbox default-expand-all node-key=\"name\"\r\n            ref=\"tree\" highlight-current @check-change=\"click\">\r\n            <span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n              <span>{{ data.name }}</span>\r\n              <span v-if=\"node.level==3\">\r\n                读权限\r\n                <el-switch v-model=\"data.read\" active-color=\"#0af\" inactive-color=\"#bbb\"\r\n                  @change=\"handleRead(data,node)\">\r\n                </el-switch>\r\n                写权限\r\n                <el-switch v-model=\"data.write\" active-color=\"#0af\" inactive-color=\"#bbb\"\r\n                  @change=\"handleWrite(data,node)\">\r\n                </el-switch>\r\n              </span>\r\n            </span>\r\n          </el-tree>\r\n          <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button @click=\"isShow = false\">取 消</el-button>\r\n            <el-button type=\"primary\" @click=\"isShow = false\">确 定</el-button>\r\n          </span>\r\n        </el-dialog>\r\n      </el-form-item>\r\n      <!-- 权限名 -->\r\n      <el-form-item label=\"权限名\">\r\n        <el-input v-model=\"model.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" native-type=\"submit\">保存</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    id: {}\r\n  },\r\n  data () {\r\n    return {\r\n      model: {},\r\n      menus: [],\r\n      nodes: [],\r\n      isShow: false\r\n    }\r\n  },\r\n  methods: {\r\n    // 保存\r\n    async save () {\r\n      // console.log(this.model);\r\n      \r\n      if (this.id) {\r\n        await this.$http.put(`rest/powers/${this.id}`, this.model)\r\n      } else {\r\n        await this.$http.post('rest/powers', this.model)\r\n      }\r\n      this.$router.push('/powers/list')\r\n      this.$message.success('保存成功')\r\n    },\r\n    //获取编辑菜单\r\n    async fetch () {\r\n      const res = await this.$http.get(`rest/powers/${this.id}`)\r\n      this.model = res.data\r\n      // console.log(res.data);\r\n    },\r\n    //合并重复项\r\n    merge (a, b) {\r\n      a.write = a.write || b.write\r\n      a.read = a.read || b.read\r\n      if (!a.children || !a.children.length) return\r\n      for (let i in b.children) {\r\n        this.merge(a.children[i], b.children[i])\r\n      }\r\n    },\r\n    // 获取权限菜单\r\n    async fetchGetMenus () {\r\n      const resMenu = await this.$http.get(`rest/menus`)\r\n      this.menus = resMenu.data.filter(i => {\r\n        if (i.level == 1) return true\r\n        return false\r\n      })\r\n      // console.log(this.menus);\r\n      if (this.id) {\r\n        const resPower = await this.$http.put(`rest/powers/${this.id}`, this.model)\r\n        this.nodes = resPower.data.nodes\r\n        this.menus.forEach((n, x) => {\r\n          resPower.data.children.forEach((i) => {\r\n            if(i.name==n.name){\r\n              this.menus.splice(x,1,i)\r\n            }\r\n          })\r\n        })\r\n        // console.log(this.menus);\r\n      }\r\n      this.clearLastChild(this.menus)\r\n      // console.log(this.menus);\r\n\r\n    },\r\n    // 清除末尾菜单的children项\r\n    clearLastChild (arr) {\r\n      for (let i = 0; i < arr.length; i++) {\r\n        if (!arr[i].children||!arr[i].children.length) {\r\n          delete arr[i].children\r\n        } else {\r\n          this.clearLastChild(arr[i].children)\r\n        }\r\n      }\r\n    },\r\n    // 开启弹窗\r\n    getPower () {\r\n      this.isShow = true\r\n    },\r\n    // 同步后代字段\r\n    collect (b, field) {\r\n      const flag = b[field]\r\n      if (b.children && b.children.length) {\r\n        let ch = b.children\r\n        for (let i = 0; i < ch.length; i++) {\r\n          let pre = ch[i][field]\r\n          ch[i][field] = pre || this.collect(ch[i], field)\r\n        }\r\n        b[field] = ch.some(child => {\r\n          return this.collect(child, field)\r\n        })\r\n      }\r\n      return b[field] || flag\r\n    },\r\n    // 关闭弹窗，保存数据\r\n    saveMenu () {\r\n      // console.log(this.menus);\r\n      this.model.children = this.menus.filter(menu => {\r\n        this.collect(menu, 'read')\r\n        this.collect(menu, 'write')\r\n        return menu.read\r\n      })\r\n      // console.log(this.model.children);\r\n      // this.model.children = this.menus\r\n      this.model.nodes = this.$refs.tree.getCheckedKeys()\r\n    },\r\n    // 节点点击\r\n    click (data, s, c) {\r\n      if (s) {\r\n        data.read = true\r\n        if (c && data.children && data.children.length) {\r\n          data.children.forEach(i => {\r\n            i.read = true\r\n          })\r\n        }\r\n      } else {\r\n        data.read = false\r\n        this.handleRead(data)\r\n      }\r\n    },\r\n    // 读权限开关\r\n    handleRead (data, node) {\r\n      if (node != undefined) {\r\n        this.syncNode(data, node)\r\n      }\r\n      if (!data.read && data.write) {\r\n        data.write = false\r\n      }\r\n    },\r\n    // 写权限开关\r\n    handleWrite (data, node) {\r\n      if (node != undefined) {\r\n        this.syncNode(data, node)\r\n      }\r\n      if (!data.read && data.write) {\r\n        data.write = false\r\n        this.$message.warning('请先开启读权限')\r\n      }\r\n    },\r\n    // 开关同步节点状态\r\n    syncNode (data, node) {\r\n      if (data.read) {\r\n        const arrget = this.$refs.tree.getCheckedKeys()\r\n        if (arrget.length) {\r\n          this.$refs.tree.setChecked(node.key, true)\r\n        } else {\r\n          this.$refs.tree.setCheckedKeys([node.key])\r\n        }\r\n      } else {\r\n        const arrget = this.$refs.tree.getCheckedKeys()\r\n        if (arrget.length) {\r\n          this.$refs.tree.setChecked(node.key, false)\r\n        } else {\r\n          this.$refs.tree.setCheckedKeys([])\r\n        }\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.id && this.fetch()\r\n    this.fetchGetMenus()\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 8px;\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PowerEdit.vue?vue&type=template&id=a4771dc8&scoped=true&\"\nimport script from \"./PowerEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./PowerEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PowerEdit.vue?vue&type=style&index=0&id=a4771dc8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a4771dc8\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar $some = require('../internals/array-iteration').some;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('some');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('some');\n\n// `Array.prototype.some` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.some\n$({ target: 'Array', proto: true, forced: !STRICT_METHOD || !USES_TO_LENGTH }, {\n  some: function some(callbackfn /* , thisArg */) {\n    return $some(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerEdit.vue?vue&type=style&index=0&id=a4771dc8&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerEdit.vue?vue&type=style&index=0&id=a4771dc8&scoped=true&lang=css&\"","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"about\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"系统管理\")]),_c('el-breadcrumb-item',[_vm._v(\"权限列表\")])],1),_c('el-table',{attrs:{\"data\":_vm.items,\"size\":\"mini\",\"stripe\":\"\",\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"_id\",\"label\":\"ID\",\"width\":\"300\"}}),_c('el-table-column',{attrs:{\"label\":\"权限名\",\"width\":\"200\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"effect\":\"dark\",\"type\":_vm.getStyle(scope.row.level)}},[_vm._v(_vm._s(scope.row.name))])]}}])}),_c('el-table-column',{attrs:{\"type\":\"expand\",\"label\":\"权限树\",\"width\":\"200\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tree',{ref:\"tree\",attrs:{\"data\":scope.row.children,\"default-checked-keys\":scope.row.nodes,\"show-checkbox\":\"\",\"default-expanded-keys\":scope.row.nodes,\"node-key\":\"name\",\"accordion\":\"\",\"highlight-current\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"custom-tree-node\"},[_c('span',[_vm._v(_vm._s(data.name))]),(node.level==3)?_c('span',[_vm._v(\" 读权限 \"),_c('el-switch',{attrs:{\"active-color\":\"#0af\",\"disabled\":\"\",\"inactive-color\":\"#bbb\"},on:{\"change\":function($event){return _vm.handleRead(data,node)}},model:{value:(data.read),callback:function ($$v) {_vm.$set(data, \"read\", $$v)},expression:\"data.read\"}}),_vm._v(\" 写权限 \"),_c('el-switch',{attrs:{\"active-color\":\"#0af\",\"disabled\":\"\",\"inactive-color\":\"#bbb\"},on:{\"change\":function($event){return _vm.handleWrite(data,node)}},model:{value:(data.write),callback:function ($$v) {_vm.$set(data, \"write\", $$v)},expression:\"data.write\"}})],1):_vm._e()])}}],null,true)})]}}])}),_c('el-table-column',{attrs:{\"fixed\":\"right\",\"label\":\"操作\",\"min-width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return (scope.row.read==null)?[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.$router.push((\"/powers/edit/\" + (scope.row._id)))}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.remove(scope.row)}}},[_vm._v(\"删除\")])]:undefined}}],null,true)})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"about\">\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>系统管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>权限列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n\r\n    <el-table :data=\"items\" size=\"mini\" stripe border>\r\n      <el-table-column prop=\"_id\" label=\"ID\" width=\"300\"></el-table-column>\r\n      <el-table-column label=\"权限名\" width=\"200\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-tag effect=\"dark\" :type=\"getStyle(scope.row.level)\">{{scope.row.name}}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column type=\"expand\" label=\"权限树\" width=\"200\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-tree :data=\"scope.row.children\" :default-checked-keys=\"scope.row.nodes\" show-checkbox\r\n            :default-expanded-keys=\"scope.row.nodes\" node-key=\"name\" accordion ref=\"tree\" highlight-current \r\n            >\r\n            <span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n              <span>{{ data.name }}</span>\r\n              <span v-if=\"node.level==3\">\r\n                读权限\r\n                <el-switch v-model=\"data.read\" active-color=\"#0af\" disabled inactive-color=\"#bbb\"\r\n                  @change=\"handleRead(data,node)\">\r\n                </el-switch>\r\n                写权限\r\n                <el-switch v-model=\"data.write\" active-color=\"#0af\" disabled inactive-color=\"#bbb\"\r\n                  @change=\"handleWrite(data,node)\">\r\n                </el-switch>\r\n              </span>\r\n            </span>\r\n          </el-tree>\r\n        </template>\r\n      </el-table-column>\r\n      <!-- 读权限 -->\r\n      <!-- <el-table-column label=\"读权限\" width=\"120\" align=\"center\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.read!=null\">\r\n          <el-tag effect=\"dark\" :type=\"scope.row.read?'':'info'\">{{scope.row.read?'开':'关'}}</el-tag>\r\n        </template>\r\n      </el-table-column> -->\r\n      <!-- 写权限 -->\r\n      <!-- <el-table-column label=\"写权限\" width=\"120\" align=\"center\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.write!=null\">\r\n          <el-tag effect=\"dark\" :type=\"scope.row.write?'':'info'\">{{scope.row.write?'开':'关'}}</el-tag>\r\n        </template>\r\n      </el-table-column> -->\r\n      <el-table-column fixed=\"right\" label=\"操作\" min-width=\"150\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.read==null\">\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"$router.push(`/powers/edit/${scope.row._id}`)\">编辑</el-button>\r\n          <el-button type=\"primary\" size=\"mini\" @click=\"remove(scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      items: [],\r\n      tagType: ['', 'warning', 'info']\r\n    }\r\n  },\r\n  methods: {\r\n    async fetch () {\r\n      const res = await this.$http.get('rest/powers')\r\n      this.items = res.data\r\n      // console.log(res.data)\r\n    },\r\n    async remove (row) {\r\n      this.$confirm(`是否确认要删除权限 \"${row.name}\"`, '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(async () => {\r\n        await this.$http.delete(`rest/powers/${row._id}`)\r\n        this.$message.success('删除成功!')\r\n        this.fetch()\r\n      })\r\n    },\r\n    getStyle (level) {\r\n      return level ? this.tagType[level - 1] : 'danger'\r\n    }\r\n  },\r\n  created () {\r\n    this.fetch()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-tag {\r\n  margin-right: 10px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PowerList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PowerList.vue?vue&type=template&id=086aa685&scoped=true&\"\nimport script from \"./PowerList.vue?vue&type=script&lang=js&\"\nexport * from \"./PowerList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PowerList.vue?vue&type=style&index=0&id=086aa685&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"086aa685\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}